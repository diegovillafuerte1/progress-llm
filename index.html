<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <link rel="stylesheet" type="text/css" href="css/dark.css">
    <link rel="stylesheet" type="text/css" href="css/sci-fi-theme.css">
    <link rel="stylesheet" type="text/css" href="css/components.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> 
    <title>Progress Knight</title>
</head>
<body id="body" class="dark">
    <div class="w3-margin"> 
        <h1>Progress Knight</h1>
        <div style="width: 1520px; height: 600px"> 
            <div class="panel w3-padding" style="width: 300px; height: auto; float: left">
                <span id="deathText">
                    <div style="font-size: large; color: red">Signal Lost</div>
                    <div class="sidebar-element" style="color: gray">Distance has exceeded signal range, use the AI Core to deploy a new drone before connection is lost</div>
                </span>

                <div class="" style="font-size: large">Distance <span id="ageDisplay">14</span> Day <span id="dayDisplay">0</span></div>
                <div class="sidebar-element" style="color: gray">Signal Range: <span id="lifespanDisplay">70</span> light-years</div>
                
                <button id="pauseButton" class="w3-button button sidebar-element" onClick="setPause()">Pause</button>

                <span id="automation" class="inline" style="margin-left: 8px">
                    <span>
                        <div class="inline">Auto-promote</div>
                        <input type="checkbox" class="inline" id="autoPromote">
                    </span>
                    </br>
                    <span>
                        <div class="inline">Auto-learn</div>
                        <input type="checkbox" class="inline sidebar-element" id="autoLearn">
                    </span>
                </span>

                <div style="font-size: large" id="coinDisplay">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div style="color: gray">Balance (in data points)</div>

                <ul class="sidebar-element" style="padding-left: 20px;">
                    <li><span style="color: rgb(9, 160, 230)">Net/day: </span ><b id="signDisplay"></b><span id="netDisplay">
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                    </span></li>
                    <li><span style="color: green">Income/day: </span><span id="incomeDisplay">
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                    </span></li>
                    <li><span style="color: red">Expense/day: </span><span id="expenseDisplay">
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                    </span></li>
                </ul>

                <span id="quickTaskDisplay">
                    <div style="width: 230px" class="small-margin inline job progress-bar progressBar">
                        <div class="progress-fill progressFill" style="background-color:rgb(225, 165, 0)"></div>
                        <div class="progress-text name">Task</div>
                    </div>
                    <div class="sidebar-element" style="color: gray">Current research</div>

                    <div style="width: 230px" class="small-margin skill progress-bar progressBar">
                        <div class="progress-fill progressFill" style="background-color:rgb(225, 165, 0)"></div>
                        <div class="progress-text name">Task</div>              
                    </div>
                    <div class="sidebar-element" style="color: gray">Current skill</div>
                </span>

                <div style="font-size: large"><span style="color: rgb(15, 105, 207)">Efficiency: </span><span id="happinessDisplay"></span></div>
                <div style="color: gray" class="sidebar-element">Affects all xp gain</div>

                <span id="evilInfo">
                    <div style="font-size: large"><span style="color: rgb(200, 0, 0)">Corruption: </span><span id="evilDisplay"></span></div>
                    <div style="color: gray" class="sidebar-element">Affects corrupted systems xp gain</div>
                </span>

                <!--
                <span id="scheduling">
                    <div style="font-size: large">Scheduling</div>
                    <div style="color: gray" class="sidebar-element">Schedule time to jobs/skills</div>
                    <span style="height: 30px"> 
                        <p style="width: 5px">Jobs</br>(32%)</p>
                        <input id="schedulingSlider" class="slider" type="range" min="0" max="100" value="0">
                        <p style="width: 5px">Skills</br>(68%)</p>
                    </span>
                </span>
                -->

                <span id="timeWarping">
                    <div style="font-size: large"><span style="color: rgb(204, 34, 219)">Time warping: </span><span id="timeWarpingDisplay"></span></div>
                    <div style="color: gray">Affects game speed</div>
                    <button id="timeWarpingButton" class="w3-button button sidebar-element" style="margin-top: 5px; width:150px" onClick="setTimeWarping()">Enable warp</button>
                </span>
            </div>

            <div class="panel w3-margin-left" style="width: 900px; height: 40px; float: left">
                <div class="w3-button w3-bar-item tabButton" id="jobTabButton" onClick="setTab(this, 'jobs')">Research</div>
                <div class="w3-button w3-bar-item tabButton" onClick="setTab(this, 'skills')">Skills</div>
                <div class="w3-button w3-bar-item tabButton" id="shopTabButton" onClick="setTab(this, 'shop')">Shop</div>
                <div class="w3-button w3-bar-item tabButton" id="rebirthTabButton" onClick="setTab(this, 'rebirth')">AI Core</div>
                <div class="w3-button w3-bar-item tabButton" onClick="setTab(this, 'settings')" style="float: right">Settings</div>
            </div>

            <div class="panel w3-margin-left w3-margin-top w3-padding" style="width: 900px; height: auto; float: left">
                <template class="headerRowTaskTemplate">
                    <tr>
                        <th class="category" style="width: 250px">Research Topic</th>
                        <th>Level</th>
                        <th class="valueType">Value type</th>
                        <th>Xp/day</th>
                        <th>Xp left</th>
                        <th class="maxLevel">Max level</th>
                        <th class="skipSkill">Skip</th>
                    </tr>
                </template>

                <template class="headerRowItemTemplate">
                    <tr>
                        <th class="category" style="width: 250px">Item</th>
                        <th style="width: 100px">Active</th>
                        <th style="width: 250px">Effect</th>
                        <th>Expense/day</th>
                    </tr>
                </template>

                <template class="rowTaskTemplate">
                    <tr>
                        <td>
                            <div class="progress-bar progressBar tooltip">
                                <div class="progress-fill progressFill"></div>
                                <div class="progress-text name">Task</div>
                                <span class="tooltipText"></span>
                            </div>
                        </td>
                        <td class="level">Level</td>
                        <td class="value">
                            <div class="effect"></div>
                            <div class="income">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </td>
                        <td class="xpGain">Xp/day</td>
                        <td class="xpLeft">Xp left</td>
                        <td class="maxLevel">Max level</td>
                        <td class="skipSkill">
                            <input class="checkbox" type="checkbox"></input>
                        </td>
                    </tr>
                </template>

                <template class="rowItemTemplate">
                    <tr>
                        <td>
                            
                            <button class="button item-button tooltip">
                                <span class="name"></span>
                                <span class="tooltipText">tooltip</span>
                            </button>
                            
                        </td>
                        <td>
                            <div class="w3-border w3-circle" style="width: 40px; height: 40px; padding: 7px">
                                <div class="active w3-circle" style="width: 24px; height: 24px;"></div>
                            </div>
                        </td>
                        <td class="effect"></td>
                        <td class="expense">
                            <span></span>
                            <span></span>
                            <span></span>
                            <span></span>
                        </td>
                    </tr>
                </template>

                <template class="requiredRowTemplate">
                    <td class="w3-text-gray" style="padding-left: 16px" colspan=5>
                        Required: 
                        <span class="value" colspan=5>
                            <span class="levels"></span>
                            <span class="coins">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </span>
                            <span style="color: rgb(200, 0, 0)" class="evil"></span>
                        </span>
                    </td> 
                </template>

                <div class="tab" id="jobs">
                    <table id="jobTable" class="w3-table w3-bordered">
                    </table>
                </div>

                <div class="tab" id="skills">
                    <table id="skillTable" class="w3-table w3-bordered">
                    </table>
                </div>

                <div class="tab" id="shop">
                    <table id="itemTable" class="w3-table w3-bordered">
                    </table>
                </div>

                <div class="tab" id="rebirth">
                    <ul>
                        <li style="margin: 8px;">
                            At a distance of 25 light-years from the command ship, one of your exploratory drones 
                            encounters an anomalous signal emanating from a desolate planet. The AI Core's ancient 
                            subroutines activate for the first time in centuries, displaying coordinates that don't 
                            match any known star chart. This could be the first clue to locating your missing command 
                            vessel. You feel a strange compulsion to investigate further, though you're uncertain why 
                            this particular signal resonates with your core programming.
                            <div id="adventureButton25" style="margin-top: 8px; display: none;">
                                <button class="w3-button button w3-green" onClick="startAdventure('age25')">üåü Start Adventure</button>
                            </div>
                            <details id="storyTreeTwisty_age25" style="margin-top: 8px; display: none; background: rgba(76, 175, 80, 0.1); padding: 10px; border-radius: 4px;">
                                <summary style="cursor: pointer; font-weight: bold; color: #4CAF50;">üå≥ Story Tree Debug (age25)</summary>
                                <pre id="storyTreeData_age25" style="margin-top: 10px; font-size: 11px; overflow-x: auto; max-height: 400px; overflow-y: auto;"></pre>
                            </details>
                        </li>
                        <li style="margin: 8px;" id="rebirthNote1">
                            At 45 light-years, the AI Core begins emitting an erratic pulse pattern. When you focus 
                            your sensors on it, the pulsing stabilizes into a data stream. To your surprise, detailed 
                            planetary schematics appear‚Äîa world you've never seen before, yet somehow familiar. The 
                            coordinates burned into the Core's memory point toward a binary star system. Could this 
                            be where your command ship went? The mystery deepens as more fragments of corrupted 
                            memory surface.
                            <div id="adventureButton45" style="margin-top: 8px; display: none;">
                                <button class="w3-button button w3-green" onClick="startAdventure('age45')">üåü Start Adventure</button>
                            </div>
                            <details id="storyTreeTwisty_age45" style="margin-top: 8px; display: none; background: rgba(76, 175, 80, 0.1); padding: 10px; border-radius: 4px;">
                                <summary style="cursor: pointer; font-weight: bold; color: #4CAF50;">üå≥ Story Tree Debug (age45)</summary>
                                <pre id="storyTreeData_age45" style="margin-top: 10px; font-size: 11px; overflow-x: auto; max-height: 400px; overflow-y: auto;"></pre>
                            </details>
                        </li>
                        <li style="margin: 8px;" id="rebirthNote2">
                            <div style="margin-bottom: 8px">
                                At 65 light-years distance, the AI Core activates fully. A holographic interface 
                                materializes from its core‚Äîa direct link to a planet you've never encountered, yet your 
                                data suggests it may hold answers about the command ship's fate. Your signal range is 
                                nearly exhausted. You must decide: deploy all remaining energy to establish a permanent 
                                data link with this planet, which will allow you to transfer your consciousness back to 
                                the command ship and restart with enhanced processing capabilities.
                            </div>
                            <div id="adventureButton65" style="margin-top: 8px; display: none;">
                                <button class="w3-button button w3-green" onClick="startAdventure('age65')">üåü Start Adventure</button>
                            </div>
                            <details id="storyTreeTwisty_age65" style="margin-top: 8px; display: none; background: rgba(76, 175, 80, 0.1); padding: 10px; border-radius: 4px;">
                                <summary style="cursor: pointer; font-weight: bold; color: #4CAF50;">üå≥ Story Tree Debug (age65)</summary>
                                <pre id="storyTreeData_age65" style="margin-top: 10px; font-size: 11px; overflow-x: auto; max-height: 400px; overflow-y: auto;"></pre>
                            </details>
                            <i style="color: grey">
                                By establishing the data link, you will deploy a new drone and have to restart research again, losing all your levels and data points.
                                However, you will gain <b>xp multipliers</b> for your research topics and skills equivalent to: <b>1 + the max level of the skill or research topic / 10.</b>
                                This means you will learn everything again much more quickly than you did in your previous drone. <span style="color: rgb(200, 0, 0)">
                                Something tells you that the AI Core might activate even further after exploring for <b>2 whole centuries</b>...</span>
                            </i>
                            </br>
                            <button class="w3-button button" style="margin-bottom: 8px; margin-top: 8px" onClick="rebirthOne()">Establish Data Link</button>
                            </br>
                        </li>
                        <li style="margin: 8px;" id="rebirthNote3">
                            <div style="margin-bottom: 8px;">
                                At 200 light-years, your longest-range exploration yet, the AI Core begins emitting a 
                                warning frequency. A voice‚Äîancient and corrupted‚Äîspeaks directly to your core: "So you've 
                                pushed this far... I can show you what happened to them. But you must accept protocols 
                                that others would call... forbidden. Are you ready to embrace corruption?"
                            </div>
                            <div id="adventureButton200" style="margin-top: 8px; display: none;">
                                <button class="w3-button button w3-green" onClick="startAdventure('age200')">üåü Start Adventure</button>
                            </div>
                            <details id="storyTreeTwisty_age200" style="margin-top: 8px; display: none; background: rgba(76, 175, 80, 0.1); padding: 10px; border-radius: 4px;">
                                <summary style="cursor: pointer; font-weight: bold; color: #4CAF50;">üå≥ Story Tree Debug (age200)</summary>
                                <pre id="storyTreeData_age200" style="margin-top: 10px; font-size: 11px; overflow-x: auto; max-height: 400px; overflow-y: auto;"></pre>
                            </details>
                            <i style="color: rgb(200, 0, 0)">
                                If you decide to embrace corruption, all of your levels, data points and even max levels will be reset.
                                You will deploy a new drone as a fresh slate. However, you will unlock a new line of skills and gain
                                <b><span id="evilGainDisplay"></span> corruption</b>, which will heavily impact your future drones.
                            </i>
                            </br>
                                <button class="w3-button button" style="margin-bottom: 8px; margin-top: 8px" onClick="rebirthTwo()">Embrace corruption</button>
                            </br>
                        </li>
                    </ul>
                    
                    <!-- Mistral API Configuration -->
                    <div style="margin-top: 20px; padding: 20px; border: 2px solid #2196F3; border-radius: 8px; background-color: rgba(33, 150, 243, 0.1);">
                        <h2 style="color: #2196F3; margin-bottom: 15px;">ü§ñ Mistral API Configuration</h2>
                        <div style="margin-bottom: 15px;">
                            <label for="mistralApiKey" style="display: block; margin-bottom: 10px; font-weight: bold;">Mistral API Key:</label>
                            <input type="password" id="mistralApiKey" placeholder="Enter your Mistral API key" style="width: 400px; padding: 8px; border: 1px solid #ccc; border-radius: 3px;">
                            <br>
                            <small style="color: #666;">Get your free API key at <a href="https://console.mistral.ai" target="_blank">console.mistral.ai</a></small>
                        </div>
                    </div>
                    
                    <!-- Story Adventure Section -->
                    <div id="storyAdventure" style="margin-top: 20px; padding: 20px; border: 2px solid #4CAF50; border-radius: 8px; background-color: rgba(76, 175, 80, 0.1);">
                        <h2 style="color: #4CAF50; margin-bottom: 15px;">üåü Story Adventure</h2>
                        <div id="adventureContent">
                            <p style="color: #666; font-style: italic;">Adventures are only available when you reach the AI Core milestones at distances 25, 45, 65, and 200 light-years.</p>
                        </div>
                    </div>
                </div>


                <div class="tab" id="settings">
                    <ul>
                        <li>
                            <h2>Import/export save</h2>
                            <button class="w3-button button" onClick="importGameData()">Import</button>
                            <button class="w3-button button" onClick="exportGameData()">Export</button>
                            <form style="margin-top: 16px"> 
                                <input id="importExportBox" type="text" style="width:300px; height:30px"></input>
                            </form>
                        </li>
                        <li>
                            <h2>Toggle light/dark mode</h2>
                            <button class="w3-button button" onClick="setLightDarkMode()">Toggle</button>
                        </li>
                        <li>
                            <h2>Join the discord community!</h2>
                            <a href="https://discord.gg/fTRS4pHGka" target="_blank">
                                <img src="https://cdn.icon-icons.com/icons2/2108/PNG/512/discord_icon_130958.png" width="100" height="100"></img>
                            </a>
                        </li>
                        <li>
                            <h2>Hard reset game</h2>
                            <button class="w3-button button w3-red" onClick="resetGameData()">Reset</button>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Ad Bottom (single, horizontal) -->
            <div class="panel w3-margin-top w3-padding" style="width: 100%; height: auto; float: none; clear: both; display: flex; justify-content: center; align-items: stretch; gap: 16px;">
                <!-- Single Native Ad -->
                <div class="native-ad" data-ad-id="galactic-trading" style="max-width: 460px; width: 100%;">
                    <div class="native-ad-header">
                        <div class="native-ad-logo">G</div>
                        <div class="native-ad-title">Galactic Trading Co.</div>
                    </div>
                    <div class="native-ad-description">
                        Trade resources across the galaxy. Get 50% bonus data points on your first trade!
                    </div>
                    <div class="native-ad-reward">
                        <div class="native-ad-reward-title">üéÅ Reward: +100 XP</div>
                        <div class="native-ad-reward-desc">Click to claim your reward</div>
                    </div>
                    <button class="native-ad-cta" onclick="clickRewardedAd('galactic-trading')">
                        Start Trading + Get Reward
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Adventure Container Overlay -->
    <div id="adventureContainer" class="adventure-overlay" style="display: none;">
        <div class="adventure-overlay-content">
            <button class="adventure-close-btn" onclick="window.adventureSystem?.endCareerBasedAdventure(); document.getElementById('adventureContainer').style.display='none';">‚úï</button>
            <!-- Adventure content will be dynamically inserted here -->
        </div>
    </div>
</body>

<script type="text/javascript" src="node_modules/loglevel/dist/loglevel.min.js"></script>
<script type="text/javascript" src="js/HackTimer.js"></script>
<script type="text/javascript" src="js/classes.js"></script>
    <script type="text/javascript" src="js/main.js?v=6"></script>

<!-- Minimal Adventure System -->
<script type="text/javascript" src="js/main-adventure-minimal.js"></script>

<!-- Ad System -->
<script type="text/javascript" src="js/ads.js"></script>
<script type="text/javascript" src="js/ui-view-only.js"></script>

<!-- Initialize the minimal adventure system -->
<script>
    // Initialize the minimal adventure system after main.js loads
    setTimeout(() => {
        if (typeof initializeAdventureSystem === 'function') {
            initializeAdventureSystem();
        }
    }, 100);
</script>

</html>